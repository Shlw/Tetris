#include "game.h"
#include "util.h"

#include <cmath>
#include <algorithm>
#include <vector>
#include <string>
#include <cstring>

using namespace std;

template<class T> T sqr(T x) {return x * x;}

double evaluate1(Board a, const Block &block)
{
    bool reachable[MAPHEIGHT + 2][MAPWIDTH + 2];
    int reachlength[MAPHEIGHT + 2][MAPWIDTH + 2] {};
    int xmax = 0;
    for (int i = MAPHEIGHT; i > 0; --i)
        for (int j = 1; j <= MAPWIDTH; ++j) {
            if (a[i][j] > 0 && !xmax)
                xmax = i;
            if (a[i][j] > 0 || reachlength[i + 1][j] < 0)
                reachlength[i][j] = -1;
            else
                reachlength[i][j] = reachlength[i + 1][j] + 1;
            reachable[i][j] = reachlength[i][j] > 0;
        }

    double ret = 0;

    for (int i = xmax; i > 0; --i) {
        int j = 1;
        double tret = 0, bonus = xmax - i + 1;
        while (j <= MAPWIDTH) {
            if (a[i][j]) {
                ++j;
                continue;
            }
            double cnt = 0;
            int prej = j;
            while (!a[i][j])
                ++j, ++cnt;
            cnt = sqrt(cnt);
            for (int k = prej; k < j; ++k)
                if (!reachable[i][k])
                    cnt *= bonus;
            tret += cnt;
        }
        ret += (xmax - i + 1) * tret;
    }

    return -ret;
}

double evaluate2(Board a, const Block &block)
{
    a.place(block);
    int rowelim = a.eliminate();

    double land = block.x - rowelim - blockHalfHeight[block.t][block.o]
                  + (blockHeight[block.t][block.o] - 1) / 2.0 - 1;

    int cntdown[MAPHEIGHT + 2][MAPWIDTH + 2] = {};
    for (int i = 1; i <= MAPHEIGHT; ++i)
        for (int j = 1; j <= MAPWIDTH; ++j)
            if (!a[i][j])
                cntdown[i][j] = 1 + cntdown[i - 1][j];

    /*
    bool visible[MAPHEIGHT+2][MAPWIDTH+2]={};
    for (int i=1;i<=MAPWIDTH;++i) visible[MAPHEIGHT+1][i]=1;
    for (int i=MAPHEIGHT;i>0;--i)
        for (int j=1;j<=MAPWIDTH;++j)
            visible[i][j]=visible[i+1][j]&&(!a[i][j]);
    */

    int rowtrans = 0;
    for (int i = 1; i <= MAPHEIGHT; ++i)
        for (int j = 1; j <= MAPWIDTH + 1; ++j)
            if (!!a[i][j] != !!a[i][j - 1])
                ++rowtrans;

    int holenum = 0;
    int row[MAPWIDTH + 2] = {};
    for (int i = MAPHEIGHT - 1; i > 0; --i) {
        for (int j = 1; j <= MAPWIDTH; ++j)
            row[j] = (!a[i][j]) & (!!a[i + 1][j] | row[j]);
        for (int j = 1; j <= MAPWIDTH; ++j)
            holenum += row[j];
    }

    int coltrans = 0;
    for (int i = 1; i <= MAPHEIGHT; ++i)
        for (int j = 1; j <= MAPWIDTH; ++j)
            if (!!a[i][j] != !!a[i - 1][j])
                ++coltrans;

    int wellsum = 0;
    for (int i = 1; i <= MAPHEIGHT; ++i)
        for (int j = 1; j <= MAPWIDTH; ++j)
            if (!a[i][j] && a[i][j - 1] && a[i][j + 1])
                wellsum += cntdown[i][j];


    return  - 4.500158825082766 * land
            + 3.4181268101392694 * rowelim
            - 3.2178882868487753 * rowtrans
            - 9.348695305445199 * coltrans
            - 7.899265427351652 * holenum
            - 3.3855972247263626 * wellsum;
}
double evaluate3(Board a, const Block &block)
{
    a.place(block);
    a.eliminate();
    int rowtrans = 0;
    for (int i = 1; i <= MAPHEIGHT; ++i)
        for (int j = 1; j <= MAPWIDTH + 1; ++j)
            if (!!a[i][j] != !!a[i][j - 1])
                ++rowtrans;

    int holenum = 0;
    int row[MAPWIDTH + 2] = {};
    for (int i = MAPHEIGHT - 1; i > 0; --i) {
        for (int j = 1; j <= MAPWIDTH; ++j)
            row[j] = (!a[i][j]) & (!!a[i + 1][j] | row[j]);
        for (int j = 1; j <= MAPWIDTH; ++j)
            holenum += row[j];
    }

    int coltrans = 0;
    for (int i = 1; i <= MAPHEIGHT; ++i)
        for (int j = 1; j <= MAPWIDTH; ++j)
            if (!!a[i][j] != !!a[i - 1][j])
                ++coltrans;

    int wellsum = 0;
    for (int i = 1; i <= MAPHEIGHT; ++i)
        for (int j = 1; j <= MAPWIDTH; ++j)
            if (!a[i][j] && a[i][j - 1] && a[i][j + 1])
                wellsum++;
    //wellsum+=cntdown[i][j];

    int maxheight = 0;
    for (int i = MAPHEIGHT; i >= 1; --i) {
        int cnt = 0;
        for (int j = 1; j <= MAPWIDTH; ++j)
            if (a[i][j])
                ++cnt;
        if (cnt) {
            maxheight = i;
            break;
        }
    }
    double __network_e3(double x1, double x2, double x3, double x4, double x5);
    return __network_e3(rowtrans / 40.0, holenum / 15.0, coltrans / 40.0, wellsum / 20.0, maxheight / 15.0);
}

double __network_e3(double x1, double x2, double x3, double x4, double x5)
{
    static const int N = 30;
    static const int M = 5;

    struct Matrix {
        int n, m;
        double *a;
        Matrix(int n, int m, const void *src)
        {
            this->n = n, this->m = m;
            a = new double[n * m];
            if (src)
                memcpy(a, src, sizeof(double) * n * m);
            else
                memset(a, 0, sizeof(double) * n * m);
        }
        Matrix(const Matrix &x)
        {
            n = x.n, m = x.m;
            memcpy(a, x.a, sizeof(double) * n * m);
        }
        ~Matrix()
        {
            delete[] a;
        }
        double *operator[](int index)const
        {
            return a + index * m;
        }
        Matrix operator* (const Matrix &b)
        {
            Matrix f(n, b.m, NULL);
            for (int i = 0; i < n; ++i)
                for (int j = 0; j < b.m; ++j)
                    for (int k = 0; k < m; ++k)
                        f[i][j] += a[i * m + k] * b[k][j];
            return f;
        }
        Matrix operator+ (const Matrix &b)
        {
            Matrix f(n, m, a);
            for (int i = 0; i < n; ++i)
                for (int j = 0; j < m; ++j)
                    f[i][j] += b[i][j];
            return f;
        }
        void active()
        {
            for (int i = 0; i < n; ++i)
                for (int j = 0; j < m; ++j)
                    a[i * m + j] = tanh(a[i * m + j]);
        }
    };

    double l0[M] = {x1, x2, x3, x4, x5};

    double w0[M][N] = {{
            1.00509815e-01,  1.10461318e+00,  2.57487476e-01,  2.15047449e-01,
            5.82341492e-01, -4.89769906e-01, -8.80662382e-01,  2.23770991e-01,
            -9.66579020e-01, -4.46632385e-01, -7.95045495e-01,  1.29402161e-01,
            -7.97893226e-01, -8.59208226e-01,  8.22061300e-01,  7.30346203e-01,
            -8.71503770e-01, -4.19030219e-01,  6.89298809e-01, -7.17456996e-01,
            7.19670415e-01,  7.67424524e-01, -2.59716094e-01, -9.91783559e-01,
            -2.55988866e-01, -6.05071843e-01, -6.25996292e-01, -2.86449164e-01,
            -9.63495553e-01, -7.23966837e-01
        },
        {
            -5.32379687e-01,  4.51250255e-01, -7.82449096e-02, -3.50086004e-01,
            -1.11606884e+00,  1.08842492e+00,  1.36887273e-02, -7.98313260e-01,
            -7.63486803e-01, -4.44084555e-01,  9.62802231e-01,  2.56738275e-01,
            8.75539422e-01,  3.80416036e-01,  5.59752047e-01, -3.64634156e-01,
            -4.35197979e-01, -8.89326572e-01,  5.93329966e-01, -3.43077332e-01,
            -1.15820897e+00, -8.45695555e-01, -1.14501119e+00,  1.18354285e+00,
            -7.12625384e-01,  1.27580732e-01,  9.17482674e-01, -7.74281919e-02,
            -5.61433017e-01, -5.42014718e-01
        },
        {
            -3.37230206e-01,  4.55719769e-01,  8.18120658e-01, -5.55112287e-02,
            4.19183314e-01,  1.21823692e+00, -1.09338892e+00, -5.80063999e-01,
            -7.16666281e-01,  4.14591938e-01,  2.95482010e-01,  4.97371517e-02,
            1.55031085e-01,  5.22952199e-01,  6.27477109e-01,  1.54775411e-01,
            4.66942638e-01, -6.91169739e-01,  6.48950636e-01, -6.78754330e-01,
            -7.22204983e-01, -3.12758058e-01,  6.89445496e-01, -1.03190526e-01,
            -6.62501991e-01,  4.17994261e-01,  1.74819365e-01,  1.01991868e+00,
            8.68727982e-01, -6.73265696e-01
        },
        {
            1.02576993e-01,  7.54762352e-01,  9.03053761e-01,  4.16543096e-01,
            -7.47518659e-01, -4.87693459e-01,  1.19963801e-02,  5.89417160e-01,
            -8.94237384e-02,  3.94843578e-01, -1.66855097e-01,  9.81644928e-01,
            7.57184684e-01, -5.80502093e-01, -5.74097931e-01,  8.48143935e-01,
            -4.47687835e-01,  1.02170038e+00,  2.85191625e-01,  6.18198395e-01,
            6.09285474e-01, -9.40935731e-01,  1.82096437e-01,  1.33055717e-01,
            3.02527159e-01,  1.10143340e+00, -4.73779857e-01, -5.23925364e-01,
            -6.05493069e-01,  5.03565431e-01
        },
        {
            -1.06015928e-01, -7.75881469e-01,  9.17003453e-01,  7.83680797e-01,
            -2.50863552e-01,  6.14290953e-01,  7.20392704e-01, -2.74173677e-01,
            -6.65986001e-01,  1.10339522e+00,  7.12492943e-01,  6.36608362e-01,
            -2.34666258e-01, -5.46963453e-01, -1.02449569e-03,  2.10989997e-01,
            7.04491735e-01,  1.10260069e+00,  5.25089316e-02,  6.07930720e-01,
            -4.33948226e-02,  2.01764718e-01, -5.18517792e-01,  3.94082636e-01,
            -7.87127316e-01,  1.07602656e+00,  6.88843489e-01,  4.54829365e-01,
            -4.30871129e-01,  4.84710246e-01
        }
    };
    double b0[N] = { 1.25960088, -0.48572388, -0.26950654,  0.66487974, -0.02821087, -0.90870667,
                     -0.06574869, -0.77487022, -0.37228736, -0.76527017,  0.77454954,  0.10860779,
                     0.56146568, -0.60090405,  0.72354424,  0.10660904,  0.04104627,  1.10833097,
                     0.15780646, -0.03875885, -0.33327705, -0.70620853,  1.1318469,   0.61903739,
                     -0.77079934, -1.12953341,  0.8574838,  1.31741309, -0.28149715,  0.22514996
                   };
    double w1[N][N] = {{
            -7.80168176e-01, -8.95629346e-01,  5.39620459e-01,  4.03051257e-01,
            4.92828131e-01, -6.09809384e-02,  9.77309048e-01,  9.92395997e-01,
            -1.75032154e-01, -9.82751966e-01,  1.11191416e+00,  8.43947291e-01,
            6.16070271e-01,  1.84143290e-01,  5.88980436e-01, -4.70193386e-01,
            6.25456691e-01, -6.59642816e-01,  3.64543796e-01, -3.72609228e-01,
            8.34746540e-01,  3.11186373e-01, -6.72613978e-02, -7.80489981e-01,
            2.42840201e-02, -3.91289830e-01,  1.57298967e-01,  9.08782780e-02,
            -7.79237151e-01,  1.85322136e-01
        },
        {  3.19995821e-01, -2.88078487e-01, -3.26869339e-01, -5.24900019e-01,   -6.00427687e-02,  2.93893903e-01,  2.31418625e-01,  8.96641552e-01,   -1.03016186e+00,  9.72505391e-01,  1.32580042e-01,  8.60012114e-01,    5.67379236e-01, -8.71984601e-01,  7.01765180e-01,  4.17567283e-01,   -7.14643896e-01, -2.68883258e-01,  4.96635526e-01,  6.91594303e-01,   -6.69691861e-01, -1.53750986e-01, -2.54389018e-01, -1.62702501e-01,   -5.32182753e-01, -3.49158347e-01, -1.05948043e+00,  5.65689445e-01,   -5.85525632e-01,  3.82958651e-02},
        { -5.60144305e-01,  6.76824152e-01, -5.59208870e-01, -3.11909527e-01,   -1.72123134e-01,  9.37758088e-01,  5.89552581e-01,  6.92248225e-01,   -9.38006341e-01, -8.95953774e-01, -8.88359845e-01,  3.12987924e-01,    6.41909897e-01, -7.19024360e-01,  9.30201590e-01, -8.16760242e-01,   -9.89697218e-01, -2.59936512e-01, -2.98966199e-01,  4.41505127e-02,    7.31150746e-01, -4.34843674e-02, -4.01402712e-01, -5.51071882e-01,    8.00655931e-02, -7.38420784e-01, -1.03223257e-01,  1.01361287e+00,    6.40367568e-01,  5.93110859e-01},
        {  5.19142032e-01,  5.18757641e-01,  2.92657077e-01,  7.98649073e-01,   -7.23357975e-01,  1.49282254e-02,  2.90933073e-01, -9.29530919e-01,    6.06507003e-01, -9.73361194e-01, -4.98468012e-01, -6.38666272e-01,   -7.84978807e-01,  5.57711780e-01,  1.05896138e-01,  1.06928110e-01,   -9.75564539e-01,  1.87589139e-01, -2.11084098e-01,  5.43640554e-01,   -1.05680645e+00,  5.54018497e-01,  2.02288613e-01, -2.63907969e-01,   -8.46456110e-01, -8.52332786e-02,  6.20053172e-01,  3.20478350e-01,   -2.88232028e-01, -7.99638867e-01},
        { -3.62271070e-01,  2.58539528e-01,  5.62757850e-01,  6.95504963e-01,    9.68433261e-01, -8.88226151e-01,  6.21289790e-01,  2.43114054e-01,    2.26615742e-01,  5.72102845e-01,  4.97646034e-01,  5.59847653e-01,   -1.64618865e-01, -9.46802050e-02, -5.63318551e-01,  2.62069911e-01,    7.40594566e-01,  9.57921028e-01, -6.87602103e-01, -5.01050174e-01,    9.38400567e-01, -5.73671520e-01,  7.90120721e-01,  2.21381202e-01,    2.65785336e-01,  8.92025083e-02, -7.82399297e-01, -9.30667639e-01,    5.88831246e-01, -6.57226205e-01},
        {  6.80491388e-01,  4.68685739e-02,  7.70723343e-01, -1.74937680e-01,   -1.67450383e-01, -2.10337639e-01, -1.97995052e-01,  4.23554778e-01,    8.09377432e-01, -9.91594136e-01, -1.00909090e+00,  5.15870094e-01,   -6.43703997e-01,  4.21337456e-01,  6.84422195e-01, -4.98562753e-01,    2.13003397e-01, -6.37759805e-01,  6.38062283e-02,  6.12382889e-01,    6.31475210e-01,  1.27828610e+00,  2.23162144e-01, -1.90445751e-01,    7.53751516e-01,  7.96790540e-01, -1.04139246e-01, -4.65241551e-01,    5.36799431e-02,  7.74192691e-01},
        {  6.44978464e-01, -3.81463021e-01,  5.23074210e-01, -1.91743091e-01,   -8.88261572e-02,  8.61708045e-01, -1.71769917e-01, -3.67788851e-01,    3.65103602e-01, -4.01530981e-01,  7.47288525e-01, -7.65894115e-01,   -1.11270674e-01,  2.03907058e-01,  3.49752069e-01,  3.89986098e-01,   -1.94739491e-01,  4.25042599e-01,  9.41786110e-01,  7.03052104e-01,    3.45206022e-01,  2.29774073e-01, -2.10619494e-01, -2.82677095e-02,    1.80450119e-02,  7.87316740e-01,  2.55109221e-01, -9.78199720e-01,   -2.22744942e-01, -9.11116362e-01},
        { -5.89686573e-01,  1.50432035e-01,  9.90934849e-01, -8.19784462e-01,    7.39767551e-01, -4.78849202e-01, -6.36743605e-01,  4.33401138e-01,    3.19211602e-01, -2.49030933e-01,  2.54913568e-01,  7.84538329e-01,   -3.65310758e-01, -1.40776951e-02, -5.75544536e-02, -5.01993775e-01,    6.59042060e-01,  3.00178826e-01,  4.97124672e-01, -5.94104409e-01,    5.40251791e-01, -7.44634509e-01,  4.13075566e-01,  8.61882150e-01,    8.48698378e-01, -3.33920151e-01,  2.97247678e-01, -7.52343833e-01,    6.42025471e-03,  8.65242004e-01},
        { -7.48481929e-01,  7.31857955e-01, -6.40789270e-01, -6.57816455e-02,   -6.31115735e-01,  6.42113388e-01, -9.75583792e-01,  4.05672759e-01,   -6.02630749e-02,  8.30223024e-01, -5.18703043e-01, -4.65044826e-01,    2.19333872e-01, -1.97860450e-01, -3.50973219e-01,  7.62736082e-01,   -4.26864088e-01, -6.74028516e-01,  9.44081008e-01,  8.41020525e-01,    1.01587391e+00,  9.22442973e-01,  9.56716061e-01,  2.58251846e-01,   -9.49080959e-02,  6.82052970e-01, -3.01237881e-01, -3.00335288e-01,    1.49808777e-02, -9.59359646e-01},
        { -1.82785839e-01,  5.00785172e-01,  3.01432818e-01, -3.91693227e-02,    2.62506515e-01, -2.53067940e-01, -9.23806429e-01, -1.87304765e-01,    9.22246516e-01, -4.60472375e-01, -4.88393724e-01, -5.12755454e-01,    1.30006015e-01, -4.60887313e-01, -3.19700301e-01,  9.78869438e-01,    4.98071015e-01, -3.39580536e-01,  3.41752380e-01, -4.12261218e-01,   -6.06693447e-01,  7.85917461e-01,  5.95806301e-01,  3.66546631e-01,    4.48597185e-02,  8.30953479e-01,  4.46779370e-01,  3.89593840e-01,   -1.17750561e+00, -1.03477407e+00},
        { -5.91814399e-01, -8.25465083e-01, -3.66729379e-01,  5.59554219e-01,   -5.19052669e-02,  6.03661120e-01, -3.01900119e-01,  7.86953807e-01,    3.20384651e-02,  3.52616489e-01, -4.85923111e-01,  7.23019481e-01,   -4.68645304e-01,  2.06597686e-01,  9.19721723e-01, -1.76532075e-01,    4.67396051e-01,  6.98681116e-01,  9.98104095e-01, -6.10170305e-01,   -1.60078228e-01,  1.33502215e-01,  7.32565522e-01,  5.35625875e-01,   -9.56228197e-01, -6.05565608e-01, -8.06104898e-01,  7.81172752e-01,   -4.98421550e-01, -1.93967313e-01},
        { -4.75609869e-01, -6.74892426e-01, -8.23390901e-01, -9.75209713e-01,   -3.87302130e-01,  1.40315264e-01, -9.65383589e-01,  6.69273674e-01,    4.82925057e-01,  3.77203554e-01,  5.32049179e-01,  9.89901900e-01,    6.55754864e-01,  4.24493819e-01,  9.39964831e-01, -7.84359753e-01,   -3.77492458e-02, -9.82309639e-01,  7.98136055e-01, -1.00813115e+00,    5.89307725e-01, -4.28313076e-01,  1.73748001e-01, -6.29655480e-01,    5.06161928e-01,  9.56816494e-01, -1.12358558e+00, -4.94542301e-01,   -5.42712927e-01, -6.00816667e-01},
        { -2.22459286e-01, -2.49677226e-01, -8.64109769e-02, -9.24658477e-01,    9.13502350e-02,  5.03853023e-01,  8.19192588e-01, -5.33932924e-01,   -1.03275919e+00, -2.68241405e-01, -9.36074376e-01, -3.31001848e-01,   -6.08168960e-01,  7.20273495e-01, -7.19468951e-01,  2.60350198e-01,   -3.54415715e-01, -5.04201770e-01, -3.66668582e-01, -7.78728724e-01,   -8.68623137e-01,  7.91184247e-01, -5.33131719e-01, -6.39046311e-01,    6.57079041e-01,  2.20542550e-01,  3.44215989e-01, -6.17678463e-01,    9.52163935e-01,  4.36118782e-01},
        {  6.75094903e-01,  7.13702515e-02, -5.22236466e-01, -1.90311953e-01,    7.48080254e-01, -1.00151205e+00,  6.28249705e-01, -1.90004840e-01,    8.25005531e-01,  9.32368219e-01, -5.15219748e-01, -5.30520260e-01,   -1.85441718e-01,  7.16865957e-01, -6.78566322e-02, -7.22614527e-01,    7.84989893e-01,  6.37610972e-01,  4.28386293e-02,  6.80512190e-01,    6.80570841e-01, -7.72876143e-01, -4.21003610e-01, -7.77609706e-01,    5.98552942e-01,  8.84423405e-02, -6.99672520e-01, -3.84726346e-01,    5.19282281e-01,  2.66087174e-01},
        {  7.39015639e-01, -7.11205959e-01,  7.56169558e-01,  1.98044211e-01,    1.04237258e-01,  5.77434778e-01, -5.71562231e-01, -4.97400820e-01,   -8.18655252e-01, -3.98426533e-01, -3.03023636e-01,  6.28663123e-01,    8.80553663e-01,  7.24728107e-01,  5.47281578e-02, -5.35464168e-01,    9.03608501e-02,  6.85940683e-01,  4.62548643e-01,  3.32356319e-02,    2.16008887e-01, -4.13751274e-01, -9.00277078e-01, -2.81256884e-01,   -7.52587795e-01,  1.05815858e-01,  3.34420532e-01,  1.91736817e-01,    1.14823902e+00, -4.32893515e-01},
        {  2.23270372e-01,  6.92664862e-01, -1.01377344e+00,  3.56205970e-01,    1.01195760e-01,  3.34931582e-01,  1.71743751e-01,  8.22584689e-01,    2.25080587e-02,  4.83103871e-01,  1.79685891e-01, -7.91256845e-01,   -6.61559522e-01,  9.12941456e-01,  2.71110356e-01, -3.14234674e-01,   -5.09102643e-01, -7.51267135e-01, -3.97615939e-01, -1.47739768e-01,   -6.39604852e-02,  1.92728817e-01,  5.33654451e-01, -8.86692643e-01,    6.14824414e-01,  8.12795877e-01,  3.62559527e-01,  8.08790863e-01,    4.42819804e-01,  3.53353806e-02},
        {  2.54142612e-01, -9.22816634e-01,  7.59905577e-02,  7.20074236e-01,   -8.71582747e-01, -3.75421822e-01, -7.40799427e-01,  1.96472425e-02,   -7.87335396e-01,  7.57326484e-01,  7.42287040e-01, -3.23560566e-01,   -9.15329218e-01, -5.12755066e-02, -6.78630888e-01,  1.21189065e-01,    2.16763020e-02,  2.65330404e-01,  7.77267635e-01,  1.06860411e+00,   -7.23349035e-01,  8.52751017e-01, -5.85429490e-01,  9.39205706e-01,   -3.37537110e-01, -3.55026752e-01,  1.84702605e-01, -1.01692152e+00,   -3.36270571e-01, -8.18705440e-01},
        { -7.17950165e-01, -7.95528293e-01, -7.83557832e-01, -2.88497835e-01,    9.19453621e-01,  4.27002043e-01, -8.73338223e-01, -2.51823276e-01,   -7.71931410e-01,  5.53520322e-01, -7.43768811e-02, -1.64824262e-01,   -3.95367444e-02,  2.88274288e-01, -3.68056029e-01, -6.96999161e-03,    4.36001569e-01,  8.68812263e-01,  7.29879618e-01, -5.74922621e-01,   -6.59750700e-01, -8.57298672e-01,  4.01526503e-02, -4.53453332e-01,    6.42704368e-01,  3.41000110e-01, -3.65071520e-02,  6.53540671e-01,    3.95010501e-01,  1.76277608e-01},
        { -3.92202526e-01,  1.71483532e-01, -9.09324288e-01,  9.11224365e-01,    2.27932960e-01,  2.12053005e-02, -3.21680129e-01, -7.52800763e-01,    9.56038982e-02, -6.84782743e-01,  3.87146622e-02,  3.43786955e-01,    1.34142682e-01, -6.55487418e-01,  9.07439172e-01, -7.21048295e-01,   -7.61303425e-01, -4.46575075e-01,  5.48470199e-01,  4.70661432e-01,   -4.12738711e-01,  3.84654284e-01, -5.48166811e-01,  8.09318781e-01,    1.52073473e-01, -9.14068043e-01, -7.65689850e-01, -4.96983707e-01,   -3.33004028e-01,  4.29357588e-01},
        { -4.30485368e-01, -4.86461371e-01, -5.78483522e-01, -1.34900197e-01,    4.85809356e-01,  5.70446253e-01,  8.69817674e-01, -7.99086332e-01,    9.05762434e-01,  1.12511210e-01, -8.66658807e-01,  1.11954428e-01,    7.44940996e-01, -4.11231548e-01, -8.16896737e-01, -2.37230375e-01,   -1.36222854e-01,  7.07290947e-01,  4.28666711e-01, -9.79093611e-02,   -3.20741325e-04,  5.42751551e-01,  5.91686964e-01,  6.83894813e-01,   -1.23440526e-01,  6.56366765e-01,  6.46797419e-01,  1.30507678e-01,   -1.13985157e+00, -6.97863042e-01},
        {  5.01699328e-01,  5.10694921e-01,  8.44086528e-01,  1.27367647e-02,    1.95839271e-01, -3.62461925e-01, -2.62619704e-02, -3.89360964e-01,    2.16290727e-01, -4.07754987e-01,  6.58981323e-01,  5.25716126e-01,   -2.86651224e-01,  5.78386366e-01, -5.17022729e-01,  4.09027874e-01,    4.24197018e-01, -4.03410792e-01, -2.80779868e-01,  3.20981205e-01,   -8.62937391e-01, -7.03862190e-01, -5.80788314e-01, -7.60065988e-02,    6.94902599e-01,  1.37500495e-01,  1.26287282e-01,  4.32817750e-02,   -1.82411581e-01,  4.90789175e-01},
        {  1.00362551e+00, -1.27181306e-01, -4.93601501e-01,  4.08243947e-02,    4.85620052e-01, -5.35420179e-01,  1.21398307e-01,  8.72041285e-01,    3.35624754e-01, -5.29956996e-01, -3.99632245e-01, -2.36532733e-01,   -5.32144010e-01,  1.03348124e+00, -9.88973320e-01,  5.91964185e-01,   -3.77069771e-01,  1.04824500e-03, -4.76802289e-01, -5.92378139e-01,    5.81001997e-01, -7.82266915e-01,  1.43321961e-01,  1.87580720e-01,   -8.47607076e-01,  6.24871433e-01, -4.25548196e-01, -2.91536033e-01,   -2.80704618e-01,  6.48446798e-01},
        { -5.40817857e-01, -6.97690725e-01,  6.16185725e-01,  9.97802377e-01,   -2.19950631e-01, -4.80305374e-01,  9.89827275e-01,  1.66514769e-01,    5.89457750e-01, -3.74207646e-01,  5.77856958e-01, -9.07868326e-01,    3.79371881e-01,  8.48481536e-01,  1.91647634e-02,  7.08440915e-02,    7.79391944e-01, -1.74357876e-01, -1.02069032e+00,  1.71141863e-01,    5.33915818e-01, -1.33524656e+00, -5.67376792e-01, -8.83632481e-01,    6.63095772e-01, -1.08755574e-01, -6.23691827e-04,  7.53503382e-01,   -1.25289977e-01, -8.17462683e-01},
        {  1.64029226e-01,  5.31490505e-01,  1.21861063e-02, -4.40849334e-01,   -7.15614498e-01, -8.32841337e-01, -1.01322937e+00, -4.12715942e-01,    1.16342381e-02, -3.55887800e-01, -5.74970186e-01,  1.94791164e-02,    7.31105983e-01, -4.28077877e-01, -4.34220552e-01, -9.49210584e-01,   -7.94194281e-01,  8.58256161e-01, -5.08760571e-01,  3.62776875e-01,    3.14489789e-02,  8.44457328e-01, -5.59646189e-01, -7.22247064e-01,    4.60875660e-01, -9.39274132e-01,  3.83684903e-01, -6.01288006e-02,    1.50192350e-01,  3.05546075e-01},
        {  1.16552256e-01, -7.31874466e-01, -2.57031351e-01,  4.27227944e-01,    1.23147659e-01,  4.53847498e-01, -7.14542150e-01, -9.45930839e-01,    3.67739558e-01,  6.62872612e-01, -2.09430933e-01, -9.54828411e-02,    2.94577837e-01,  9.10310328e-01, -9.51827168e-01,  1.20298557e-01,   -1.70862958e-01,  7.82570004e-01,  3.45367342e-01,  1.36824533e-01,    1.75527349e-01, -7.46148407e-01,  2.81178892e-01, -2.36868978e-01,    9.54994142e-01, -4.22038734e-01, -5.31598568e-01, -1.66620925e-01,   -1.00013113e+00,  1.09989047e-01},
        {  1.16570091e+00,  1.19775809e-01, -5.10835588e-01, -2.77807593e-01,   -8.59088242e-01,  3.20002049e-01, -1.08628428e+00, -7.66916037e-01,   -3.68429601e-01,  6.11671448e-01, -8.08732331e-01,  3.25208277e-01,   -7.04483390e-01, -3.42712879e-01, -6.72386408e-01, -5.94773814e-02,   -3.05517256e-01,  1.06854312e-01,  9.52786088e-01,  3.68089795e-01,    9.45914030e-01, -5.02978086e-01, -4.92799908e-01,  2.39076674e-01,    4.86705869e-01,  1.16787545e-01,  1.02085340e+00, -4.68621910e-01,    3.47315580e-01, -2.86050946e-01},
        { -7.22265959e-01, -5.92034042e-01, -1.90097332e-01,  8.24807405e-01,   -1.00274771e-01, -5.69881320e-01,  2.43791208e-01,  2.44075492e-01,    3.22802603e-01, -1.62715971e-01, -8.43079746e-01,  4.14469659e-01,   -3.01712215e-01,  2.22449854e-01,  8.55286300e-01, -4.34219092e-01,    5.25428593e-01, -2.82847166e-01, -3.69411230e-01, -4.38966066e-01,    8.80485833e-01,  2.03450993e-01,  3.99540901e-01, -8.43882084e-01,    8.05997849e-01, -7.14105725e-01, -5.21128953e-01,  2.83330172e-01,    6.46699727e-01,  7.80452788e-02},
        {  3.15996975e-01, -2.87949443e-01, -8.79052997e-01,  9.07910943e-01,   -9.25931752e-01, -4.92409855e-01,  1.02686310e+00,  8.98279428e-01,    6.48765713e-02, -9.46082294e-01,  1.02524340e+00,  9.16362703e-01,   -5.45468926e-01, -1.68494791e-01, -3.22933465e-01, -2.51845241e-01,    7.58778870e-01,  5.16765058e-01,  1.00998473e+00, -3.50325435e-01,    5.83449364e-01, -5.22177994e-01, -3.36617976e-01, -9.52622294e-01,    6.65623665e-01,  5.84529191e-02, -6.62005246e-01, -3.98109615e-01,    3.16781551e-01,  8.69541407e-01},
        {  8.22043478e-01,  3.44536155e-01,  1.02738333e+00, -5.98914564e-01,    5.83461583e-01, -7.60495126e-01,  2.54153788e-01,  8.51802155e-02,   -7.55705953e-01, -8.05898905e-01, -1.57025799e-01,  6.78637743e-01,   -5.68381131e-01,  8.34416926e-01,  3.18775140e-02, -7.63938725e-01,   -3.75557303e-01,  3.60851616e-01,  3.16740960e-01,  4.93794680e-01,    3.41089875e-01,  9.12877202e-01, -1.13722626e-02,  9.91345882e-01,   -3.94542478e-02, -6.55974627e-01, -2.67895341e-01, -1.99051350e-01,   -4.01503444e-01, -3.45389128e-01},
        {  1.62341103e-01,  8.94543409e-01,  5.42288363e-01, -9.69077826e-01,    4.98153359e-01,  8.84559989e-01,  1.07307285e-01, -3.20513666e-01,   -6.77367568e-01, -7.16438770e-01,  1.79539874e-01, -5.99007495e-02,   -9.93830800e-01, -4.47834998e-01,  1.73023358e-01,  4.92221683e-01,   -6.36459589e-01, -3.07397038e-01,  7.92581379e-01, -7.72808492e-01,    3.86768043e-01, -4.80747446e-02,  6.14296086e-03, -3.94924700e-01,    1.07834327e+00, -1.54993147e-01,  6.32411838e-01,  2.62799680e-01,   -6.20348871e-01,  6.52943194e-01}
    };
    double b1[N] = { 0.34615904, - 0.12717046,  0.80020547, - 0.5519045,  - 0.09553719, - 0.16169518,
                     - 0.33493757,  0.26230222,  0.4613454, - 0.94873035, - 0.67890465,  0.16360921,
                     - 0.10556352, - 0.6680913,  - 0.89359963, - 0.4192498,  0.1035912, - 0.65598512,
                     - 0.297144,   - 0.50888044, - 0.73254442,  0.46036738, - 0.56700069,  0.60267729,
                     - 0.16341034,  0.65393358, - 0.39005581, - 0.51795876, - 0.49815452, 0.80727142
                   };
    double w2[N][N] = {{ -3.04159731e-01, -3.52873504e-01, -6.40143394e-01,  9.80130911e-01,    4.32336479e-01, -2.79143959e-01,  4.08038408e-01,  2.80316502e-01,    6.83030248e-01,  8.55879605e-01, -9.20304418e-01, -3.18743050e-01,   -3.13676856e-02, -8.88026357e-02,  7.19407499e-01,  5.70959330e-01,   -9.38419282e-01, -8.71301413e-01,  2.67938197e-01,  3.90461653e-01,   -9.47988391e-01,  2.88663536e-01,  8.46034765e-01, -1.05139732e+00,   -3.30280423e-01, -8.44360948e-01,  7.01641977e-01,  3.53374444e-02,    6.83120966e-01,  8.19007635e-01},
        { -6.46203697e-01, -3.19636285e-01,  5.55402040e-01,  3.45553994e-01,    9.73178804e-01,  1.66468784e-01, -5.98661125e-01,  7.28967011e-01,   -2.49177262e-01, -8.63241553e-01,  4.27994519e-01,  4.39149737e-01,   -5.21974340e-02,  7.35063195e-01,  3.48538756e-01,  2.89550155e-01,    2.22470760e-01, -7.97378361e-01,  1.85380995e-01,  6.41654134e-01,   -6.71611726e-01, -3.94341141e-01,  4.48167145e-01, -3.88549536e-01,   -4.23840076e-01,  8.92224014e-01, -8.75552535e-01,  9.08254683e-01,   -2.55518891e-02,  9.44056332e-01},
        { -2.16821954e-01, -9.53336582e-02,  1.59820154e-01,  2.80199498e-01,   -7.57045090e-01, -5.14416471e-02,  3.26140612e-01, -6.18438542e-01,    7.96483219e-01, -2.68996239e-01,  5.60427666e-01, -7.22835600e-01,    8.69101107e-01,  8.94652665e-01, -5.06564975e-01,  6.05508924e-01,   -5.65667033e-01, -8.21147621e-01,  9.22477424e-01,  7.81899467e-02,    4.52195555e-01, -3.11852902e-01,  5.38687468e-01, -4.19869155e-01,   -4.00317341e-01,  2.73996770e-01,  2.64696151e-01,  4.36075985e-01,   -2.76073683e-02,  4.25148934e-01},
        {  3.33858222e-01, -7.66392589e-01,  8.40689600e-01,  8.14203620e-01,   -4.64365512e-01,  7.56328225e-01, -8.49579155e-01,  5.18625379e-01,    1.26563728e-01,  9.12382007e-02,  5.44864237e-01, -1.07077384e+00,    7.11020470e-01, -9.38712478e-01,  2.45253369e-01, -4.35555309e-01,    3.73015612e-01, -5.85557699e-01,  6.80582106e-01,  7.46278405e-01,   -4.67630625e-01,  1.18338458e-01,  2.24677369e-01, -7.27388501e-01,   -1.37076125e-01,  4.67227608e-01, -4.75444287e-01, -9.40692604e-01,    6.77628636e-01, -6.22548401e-01},
        { -4.80085284e-01,  2.69248724e-01, -3.98492999e-02, -1.64205924e-01,    7.39524424e-01,  2.38656163e-01,  1.51435569e-01,  8.77120852e-01,   -6.37010396e-01, -1.39370337e-01,  4.73421574e-01,  6.72244072e-01,   -9.39171135e-01, -9.06805933e-01,  1.00996709e+00,  3.54647636e-02,   -5.19466102e-01,  2.17463344e-01,  3.06406170e-01, -5.69598079e-01,    9.01655316e-01, -2.93335795e-01, -3.08010548e-01,  2.78417587e-01,    6.71593308e-01, -8.55794907e-01,  6.37529567e-02,  6.49392784e-01,    3.98422509e-01,  2.19355062e-01},
        { -7.77701616e-01,  6.17334783e-01,  1.06152999e+00,  1.81193843e-01,    2.12902442e-01, -6.51016235e-01, -3.77381384e-01,  4.90772814e-01,    6.61733031e-01, -1.20117188e-01,  4.85577345e-01, -1.85859186e-04,    7.71337748e-02,  2.70436078e-01, -4.29725438e-01,  1.99994430e-01,   -6.96809962e-02,  6.45296931e-01, -3.81886542e-01,  4.01575178e-01,   -8.16095114e-01,  5.42389810e-01,  8.29478502e-01,  8.29089880e-01,    5.75963974e-01, -3.34200621e-01,  1.05740678e+00,  4.97411817e-01,    6.33800387e-01, -5.07024229e-01},
        {  4.21175152e-01, -5.71266532e-01,  2.76409358e-01, -2.34145328e-01,    9.15958360e-03,  2.16650963e-01, -5.93028545e-01, -4.79292333e-01,   -3.80990446e-01, -8.96154195e-02, -4.39014703e-01,  8.23280454e-01,    3.78064632e-01, -5.11322856e-01,  8.79902184e-01, -6.69740021e-01,   -8.92228365e-01, -1.38974145e-01, -2.28092149e-02,  1.05453956e+00,    9.96259689e-01, -9.31256294e-01,  5.62165380e-01, -8.53630662e-01,   -7.80495346e-01,  3.40404928e-01,  7.33249128e-01, -8.93556356e-01,    1.94462776e-01,  4.33250070e-01},
        { -6.82691634e-01,  8.77988804e-03, -3.37807983e-01, -9.82846498e-01,   -1.99145347e-01, -2.52831161e-01, -6.43895030e-01,  1.01374102e+00,    5.52816868e-01, -3.56411844e-01, -7.14637160e-01,  8.89604092e-01,    2.49775052e-01, -1.19201522e-02, -4.98376817e-01, -8.75984251e-01,   -1.06688428e+00,  1.99739277e-01, -5.39051354e-01, -2.58840024e-01,   -6.68343008e-01, -5.36149442e-01,  1.95779368e-01, -5.05066812e-01,    1.04831982e+00, -7.00930953e-01,  6.40219212e-01, -3.13715667e-01,    9.53886151e-01, -1.94464907e-01},
        { -1.01410531e-01, -8.23826134e-01, -3.04862767e-01, -6.25176355e-02,   -7.00576007e-01,  6.32590175e-01, -7.10279405e-01,  9.02015209e-01,   -4.66521233e-02,  4.71677423e-01, -1.70743912e-02,  1.09978843e+00,   -8.71420026e-01, -9.55139101e-01, -1.47701974e-03,  4.53673631e-01,    9.71630692e-01, -4.06497985e-01,  4.53292936e-01, -2.31001273e-01,   -3.98695230e-01, -3.10881793e-01, -5.60193434e-02,  6.24694586e-01,   -5.26251674e-01, -3.20412308e-01, -4.82985051e-03, -4.48055148e-01,    9.30210531e-01, -6.27521932e-01},
        {  6.42992735e-01, -7.68229544e-01, -9.46868956e-01, -2.24544615e-01,   -5.82168937e-01, -1.15256295e-01, -7.27261379e-02,  1.31666427e-02,    5.96401930e-01,  6.31660938e-01, -9.20106888e-01, -5.70581317e-01,   -7.04136252e-01,  1.25205114e-01, -8.78391936e-02,  5.24957955e-01,    5.77480674e-01,  7.63607502e-01, -8.03269148e-01,  5.23640990e-01,   -3.66899639e-01, -2.34214023e-01,  7.72305131e-01, -1.07979596e-01,   -2.11186945e-01, -9.21743691e-01, -8.19729626e-01,  2.83879071e-01,    4.04548720e-02,  9.32880044e-01},
        {  1.49260795e+00,  3.77359301e-01,  4.99942899e-01,  9.31009091e-03,   -8.64868045e-01, -8.35009396e-01,  7.83395171e-01, -5.46765387e-01,    5.27335107e-01,  2.85149723e-01, -9.10529494e-01,  5.16770840e-01,    2.04569489e-01, -8.69943559e-01, -2.69901633e-01, -5.31504676e-02,   -1.05975926e-01, -7.18004525e-01, -8.94360423e-01, -1.18786730e-01,    3.45189571e-01,  5.51086724e-01,  7.38516629e-01,  6.63860083e-01,    5.41062653e-01, -6.36314154e-02, -8.73590231e-01,  2.01820984e-01,   -2.87822008e-01,  5.15002429e-01},
        { -5.88515759e-01,  6.50003925e-02,  8.06111038e-01, -8.96891892e-01,   -5.01702607e-01,  8.83787125e-02, -3.84019792e-01,  5.74982703e-01,   -6.64722502e-01, -7.05812514e-01,  5.44178545e-01,  4.43558276e-01,    9.55159307e-01, -8.84253681e-01, -8.97314101e-02,  7.94810712e-01,   -7.75839090e-01, -1.26499474e-01, -9.18358445e-01,  4.81080472e-01,    2.42583901e-01,  9.56930161e-01,  4.32185084e-01, -8.91673446e-01,   -9.25687030e-02,  3.83892268e-01,  5.42798340e-01, -1.08556964e-01,   -7.43706599e-02, -3.71545136e-01},
        { -2.42475197e-01, -2.97860026e-01, -2.04876170e-01,  4.39427942e-02,   -5.34473479e-01, -4.46767360e-01, -6.70720190e-02,  7.07827926e-01,   -9.70048368e-01, -1.78040132e-01, -7.89188921e-01, -4.30986881e-01,   -7.08440125e-01,  1.04663765e+00,  5.52594364e-01, -5.43717444e-01,   -3.99774104e-01,  7.46303916e-01, -3.00549507e-01, -9.10521671e-02,    5.12463212e-01,  2.32699350e-01,  5.91625571e-01,  7.62510061e-01,   -2.78137885e-02,  9.08856511e-01, -5.42443097e-01, -1.81071952e-01,   -2.09902063e-01,  8.32127333e-01},
        {  1.07953322e+00,  5.01480937e-01, -9.34867084e-01,  9.47178304e-01,    9.12944913e-01,  2.56595582e-01,  4.11766738e-01, -3.67087603e-01,    7.35146582e-01, -4.63163257e-02, -7.87444890e-01, -1.26292408e-01,   -8.64373982e-01, -8.60662103e-01, -2.32305422e-01, -3.02994758e-01,   -2.97901660e-01, -2.30124369e-01, -2.57776320e-01,  2.59540267e-02,   -6.58676565e-01, -5.99827588e-01,  3.13358605e-01, -5.80770187e-02,    8.92315626e-01, -2.65864981e-03,  8.36505532e-01, -8.63032818e-01,    1.72592819e-01, -5.45695186e-01},
        {  7.99301028e-01,  1.84544653e-01,  6.95669174e-01, -1.73791155e-01,   -2.66158819e-01, -8.11755896e-01, -8.76845598e-01, -4.30410028e-01,   -4.46411610e-01, -9.09776926e-01, -1.05328977e-01,  7.43727565e-01,    4.79510039e-01, -6.32690668e-01,  7.65891671e-01, -8.15060437e-01,   -3.79196912e-01, -9.83303785e-02,  8.95149074e-03, -5.18148005e-01,   -9.14049447e-01,  6.00576162e-01, -9.38992918e-01,  2.51436859e-01,   -3.11553597e-01, -6.76795959e-01,  3.45292658e-01,  8.97937715e-01,   -2.67545402e-01,  6.95421100e-01},
        {  6.89226210e-01,  6.13724664e-02,  1.79891318e-01,  9.08236027e-01,    8.03507209e-01, -5.90625346e-01,  5.78007102e-01,  7.53070712e-01,   -5.33293188e-01,  3.29607390e-02,  2.55087107e-01,  2.62882918e-01,    3.23464751e-01, -6.01423979e-01, -2.82069981e-01, -1.90854400e-01,   -8.34552228e-01, -2.65627593e-01,  6.24101877e-01, -5.98657906e-01,    6.78482533e-01,  9.11905229e-01,  7.33735025e-01,  4.90052611e-01,   -5.78464091e-01,  9.30122256e-01, -4.23470616e-01, -1.20610304e-01,   -7.17871904e-01,  5.88381648e-01},
        {  4.64309812e-01,  4.73952323e-01, -9.27325606e-01, -3.52394581e-01,    5.80562770e-01,  8.39777172e-01, -6.16842926e-01, -7.02274680e-01,   -6.78129852e-01,  6.02312386e-01, -6.81065619e-01,  1.01067781e+00,    1.09282158e-01, -8.76408070e-02,  3.26656342e-01,  1.17868885e-01,   -5.12159765e-01,  2.21380070e-01,  3.53757113e-01, -5.13444424e-01,   -3.40203583e-01, -6.28760934e-01,  6.79683745e-01,  4.38978761e-01,    5.57931840e-01, -7.55650640e-01,  4.89347875e-01, -5.14449477e-01,    9.09351051e-01,  9.99891162e-01},
        { -6.78332627e-01,  3.53625298e-01, -1.92892626e-01, -7.18476474e-01,    6.24004006e-01,  6.87824070e-01, -5.91738880e-01,  2.18102232e-01,    2.44949669e-01,  3.57317217e-02,  6.93648100e-01,  3.23402405e-01,   -6.78813338e-01,  5.30825496e-01,  5.65176178e-03, -5.36867619e-01,    5.15711784e-01, -4.86141741e-01,  7.65469730e-01,  4.77102339e-01,   -9.82235432e-01,  6.00355752e-02,  2.22693354e-01,  7.28593528e-01,    5.49482644e-01,  1.21271454e-01, -3.22819464e-02, -1.04005170e+00,    4.86260146e-01, -9.40194309e-01},
        { -5.58069944e-01,  2.31162980e-01, -1.26744350e-02, -3.98351729e-01,    1.06700587e+00, -3.66066098e-01,  8.16256166e-01, -3.46626975e-02,    6.44760489e-01,  5.51577769e-02,  1.50359660e-01, -9.86969844e-02,    9.12687778e-02,  7.47977257e-01, -5.24900444e-02,  4.16995019e-01,    3.55809003e-01,  4.05848950e-01,  1.47464469e-01, -1.05461526e+00,   -6.80630922e-01, -1.45285979e-01, -4.41254564e-02, -9.05085862e-01,   -7.18780816e-01, -3.71739566e-02, -7.17958868e-01,  8.52952778e-01,    5.07836044e-01, -6.58575892e-02},
        { -1.61789164e-01, -2.10348427e-01,  4.63473022e-01,  8.15965235e-01,    3.51290464e-01,  5.12593508e-01,  8.40989828e-01, -3.64463389e-01,   -8.69023800e-01, -4.77842420e-01,  1.83243304e-01,  3.39558065e-01,   -5.80996275e-01, -1.47242993e-01,  6.03018224e-01, -9.02815521e-01,   -4.67330366e-01,  3.31100643e-01, -2.33360976e-01, -8.04678023e-01,    4.49281424e-01, -7.52653658e-01,  7.12739766e-01,  3.73617023e-01,   -8.83390844e-01,  5.58073640e-01,  2.04999670e-01, -2.47919202e-01,    5.01634419e-01,  4.83738445e-02},
        { -1.05814479e-01, -3.77550542e-01, -3.69113594e-01,  2.03574806e-01,   -5.95825970e-01,  4.12125140e-01, -6.03257596e-01, -3.10801286e-02,   -2.63767779e-01, -1.45364165e-01,  3.02894831e-01, -7.35771596e-01,    3.32779169e-01, -6.64925039e-01,  2.26505294e-01, -7.77048051e-01,   -4.41500723e-01, -7.76485741e-01, -2.98243880e-01, -8.63743424e-01,    3.82275403e-01,  2.70859331e-01,  1.30116895e-01, -1.01781428e+00,    6.12407386e-01,  1.76620081e-01, -4.54107076e-01,  6.70766877e-03,    5.24604380e-01, -1.70027897e-01},
        { -1.24146283e+00, -5.79061747e-01,  4.47187215e-01, -4.53582615e-01,    4.48209822e-01, -2.10479185e-01, -3.28113049e-01,  3.00876975e-01,   -9.69433188e-01, -2.50158727e-01,  1.40701294e+00,  4.95191701e-02,    3.65935266e-01,  9.60564613e-01, -3.09694469e-01,  1.87117144e-01,   -7.55238295e-01,  9.35551405e-01, -1.02479851e+00,  1.55701771e-01,    1.18261862e+00, -7.27524042e-01, -5.06516695e-01, -5.06686389e-01,    6.54446483e-01, -3.87566119e-01, -3.08766752e-01, -1.13278890e+00,   -7.98758090e-01,  4.34202194e-01},
        { -5.32350004e-01,  1.12516381e-01,  7.14697659e-01,  8.48563910e-01,    2.61080950e-01,  5.83131313e-01,  2.99127221e-01, -8.25015426e-01,   -1.60490200e-02, -6.56795025e-01, -8.18301678e-01,  4.80730534e-02,    8.66284072e-01, -1.33041248e-01,  1.05625331e-01,  2.04314906e-02,   -7.23709583e-01,  8.69831562e-01, -9.33867514e-01,  5.34753799e-01,    5.33377171e-01, -5.55091500e-01,  3.73202600e-02, -5.43174624e-01,   -7.53903314e-02, -5.04506588e-01,  5.01699030e-01, -1.98987126e-01,    2.20165979e-02,  2.25689247e-01},
        {  9.31437969e-01, -7.36981034e-01, -4.96674061e-01,  5.04570603e-01,   -6.10686004e-01,  1.30582809e-01,  6.27715945e-01, -6.13156021e-01,    5.87579012e-01, -5.79059869e-02,  7.44168282e-01,  1.34009719e-01,   -6.27347976e-02, -5.90869248e-01,  8.28672171e-01,  9.35607195e-01,    5.04579663e-01,  1.33625776e-01,  8.20157111e-01, -4.40286770e-02,   -2.15163663e-01, -8.69105637e-01,  4.44788903e-01, -2.56274164e-01,   -1.04687893e+00,  3.61266024e-02, -6.41421139e-01,  2.52690494e-01,    8.32553148e-01, -5.88120297e-02},
        {  9.58270431e-01,  4.96743858e-01,  5.01729846e-01,  4.07074064e-01,    1.45897210e-01, -1.39048904e-01,  3.06466877e-01,  1.83572881e-02,    9.52715516e-01,  2.30649903e-01,  5.89172281e-02,  1.10011578e+00,    7.06731677e-01,  5.84735096e-01,  2.60332227e-01,  3.57173949e-01,   -5.47961444e-02, -1.76692098e-01,  7.98595130e-01, -8.12996924e-01,    2.25520670e-01, -9.65339363e-01,  3.45790088e-01, -3.66089523e-01,   -2.23151118e-01,  4.15077031e-01,  7.14730471e-02, -8.05819929e-01,   -4.10138816e-01,  8.53551447e-01},
        {  4.63600904e-01, -2.64611632e-01, -1.08395290e+00, -6.23469234e-01,   -6.17339253e-01,  5.86744249e-01, -5.13463199e-01, -2.03324646e-01,    8.45389724e-01,  8.44157755e-01, -8.09751153e-01,  1.04031324e+00,    6.41250312e-01, -3.97674054e-01,  9.58386898e-01, -2.20064685e-01,   -8.00468564e-01, -6.49526834e-01, -3.59654725e-01, -9.19043720e-02,   -3.13583970e-01,  8.20706725e-01,  1.48073152e-01, -6.20824873e-01,   -2.42188990e-01,  6.04684830e-01,  1.51720226e-01, -4.70153421e-01,    5.59670091e-01,  8.74665618e-01},
        { -4.15963352e-01, -5.79583704e-01,  6.18535757e-01, -2.32178252e-02,    8.52857888e-01,  7.81042039e-01,  1.11448264e+00,  5.77259839e-01,   -5.93567014e-01,  7.45311379e-01,  4.67285752e-01,  7.41036236e-01,    9.12614018e-02, -9.74173069e-01,  3.35188776e-01, -3.50470021e-02,    7.92146206e-01, -8.53509545e-01,  1.67084262e-01, -3.18593115e-01,    9.59405780e-01, -7.90725291e-01, -7.44620442e-01,  7.29652464e-01,   -7.12450862e-01, -9.46809411e-01,  6.88968480e-01, -9.68602240e-01,   -6.46108031e-01, -7.70242095e-01},
        {  4.42234278e-02,  2.18751058e-01, -4.36050206e-01, -4.07247216e-01,   -1.44665718e-01, -4.90563542e-01,  5.96003652e-01,  1.01465261e+00,    5.10936007e-02, -1.44283250e-01,  9.79972184e-01, -8.63202393e-01,    1.07543182e+00, -9.28515851e-01, -2.30220199e-01, -5.44005394e-01,   -4.32664096e-01,  5.74305773e-01, -8.32253695e-01,  2.45212853e-01,    9.13783133e-01, -5.35876215e-01,  2.83981979e-01,  9.48066175e-01,    6.02867067e-01,  1.18702143e-01,  9.16199088e-01,  3.74872163e-02,    9.04603243e-01,  5.78823566e-01},
        {  6.46773934e-01, -6.13203943e-01,  6.93074107e-01,  7.22881377e-01,   -4.56857055e-01,  6.04025006e-01,  8.99332345e-01,  8.09691846e-01,   -1.91525489e-01,  5.09010077e-01, -3.09632570e-01,  4.00417507e-01,   -2.87417710e-01,  5.08307777e-02, -1.01896203e+00, -6.85797989e-01,   -7.16955245e-01, -8.84162933e-02, -4.03312743e-01,  2.48267457e-01,    5.98563015e-01,  4.47614908e-01, -2.95412332e-01,  4.65641946e-01,   -4.79417294e-01, -3.63428406e-02,  7.59943008e-01, -3.59866530e-01,    3.61633688e-01, -9.54679310e-01},
        { -3.36823046e-01,  5.54981828e-01, -6.14368320e-02,  3.88130575e-01,    3.81743371e-01, -7.16490522e-02,  8.86829197e-01,  7.03023970e-01,    2.77198106e-01,  4.89891917e-01, -5.14341533e-01,  9.31459963e-02,    3.68463904e-01, -5.47205329e-01,  7.66143799e-01, -2.24641249e-01,   -9.04166400e-01, -1.41340747e-01,  7.13976502e-01,  6.48938537e-01,   -2.64680803e-01,  8.58355641e-01, -2.23411128e-01,  5.95454633e-01,    9.67466593e-01, -6.87952101e-01, -4.05247271e-01,  8.53774995e-02,    7.27486908e-01, -9.93082345e-01}
    };
    double b2[N] = { 0.87783056,  1.03166997, - 0.07812519, - 0.22731249, - 0.13722202, - 0.74112666,
                     - 0.13215794,  1.03992307,  0.71510774, - 0.22362635,  0.17511423, - 0.26592091,
                     0.16535847,  0.21156301, 0.58891934, 0.00380758, - 0.18403412, 0.82447308,
                     0.3800678, - 0.13198149, 0.39374489, - 0.85102457, - 0.13768375, 0.67749989,
                     - 0.1225125,   0.44340369, 0.17640412,  0.96945822, - 0.10176684, 0.46813715
                   };
    double w3[N] =  {-3.77261810e+01,
                     -8.36315155e+01,
                     9.71751022e+01,
                     7.85832443e+01,
                     -9.22495728e+01,
                     -9.40716095e+01,
                     -9.76724854e+01,
                     7.87952347e+01,
                     -7.17264862e+01,
                     -6.56633682e+01,
                     2.36357212e+01,
                     5.57795334e+01,
                     6.96968079e+01,
                     -9.94914856e+01,
                     -3.72945023e+01,
                     -8.86731033e+01,
                     5.19337692e+01,
                     -5.60700912e+01,
                     8.39202728e+01,
                     -8.47637100e+01,
                     1.40966301e+01,
                     4.56532249e+01,
                     3.20994339e+01,
                     1.09531622e+01,
                     -6.48173447e+01,
                     -4.39158618e-01,
                     -7.94986038e+01,
                     -4.65928879e+01,
                     9.35356878e-03,
                     -5.97827625e+00
                    };
    double b3[1] = {-70.86511993};

    Matrix m_l0(1, M, l0);
    Matrix m_w0(M, N, w0);
    Matrix m_b0(1, N, b0);
    Matrix m_w1(N, N, w1);
    Matrix m_b1(1, N, b1);
    Matrix m_w2(N, N, w2);
    Matrix m_b2(1, N, b2);
    Matrix m_w3(N, 1, w3);
    Matrix m_b3(1, 1, b3);

    Matrix m_l1(m_l0 * m_w0 + m_b0);
    m_l1.active();
    Matrix m_l2(m_l1 * m_w1 + m_b1);
    m_l2.active();
    Matrix m_l3(m_l2 * m_w2 + m_b2);
    m_l3.active();
    Matrix ans(m_l3 * m_w3 + m_b3);
    return ans[0][0];
}
